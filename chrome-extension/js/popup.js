(()=>{"use strict";function e(){const e=Array.from(document.querySelectorAll(".tag")).map((e=>({name:e.querySelector(".tag-name").textContent,enabled:e.querySelector('input[type="checkbox"]').checked})));chrome.storage.sync.set({preferences:e}).then((()=>{console.log("Preferences saved:",e)}));const t=document.getElementById("openai-api-key").value;chrome.storage.sync.set({openai_api_key:t}).then((()=>{console.log("OpenAI API key saved.")}));const n=document.getElementById("twitter").checked,c=document.getElementById("zhihu").checked;chrome.storage.sync.set({twitter:n,zhihu:c}).then((()=>{console.log("Twitter: "+n+", Zhihu: "+c)}))}function t(e,t){const n=document.createElement("span");n.className="tag";const c=document.createElement("span");c.className="tag-name",c.textContent=e,n.appendChild(c);const o=document.createElement("input");return o.type="checkbox",o.checked=t,n.appendChild(o),n}function n(){const e=document.getElementById("preference"),n=e.value.trim();if(n){const c=document.getElementById("tag-container"),o=t(n,!0);c.appendChild(o),e.value=""}}window.addEventListener("load",(function(){chrome.storage.sync.get(["preferences"]).then((e=>{const n=document.getElementById("tag-container");(e.preferences||[]).forEach((e=>{const c=t(e.name,e.enabled);n.appendChild(c)}))})),chrome.storage.sync.get(["openai_api_key"]).then((e=>{null==e.openai_api_key||""==e.openai_api_key?(e.openai_api_key="",document.getElementById("openai-api-key").classList.add("is-invalid"),document.getElementById("openai-api-key").value=""):document.getElementById("openai-api-key").value=e.openai_api_key})),chrome.storage.sync.get(["twitter","zhihu"]).then((e=>{null==e.twitter&&(e.twitter=!0),null==e.zhihu&&(e.zhihu=!0),document.getElementById("twitter").checked=e.twitter,document.getElementById("zhihu").checked=e.zhihu})),document.getElementById("save-button").addEventListener("click",e),document.getElementById("add-preference-button").addEventListener("click",n)}))})();